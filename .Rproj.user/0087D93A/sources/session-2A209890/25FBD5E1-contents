---
title: "Community Selection Criteria"
author: "Yohan Min"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
---

# Necessary libraries
```{r}
library(tidyr)
library(dplyr)
library(stringr)
library(stringdist)
library(tidyverse)
library(readr)
library(sf)
library(stargazer)
library(Hmisc)

knitr::opts_chunk$set(echo = TRUE)
```


# Data to be ready
```{r}
load("C:/Users/yohan/Big_data/US Tract/census.Rdata") # census GEOID
data <- read_csv("./data/steel_iron_facility.csv") # steel data
DAC <- read_csv("https://github.com/reconjohn/disadvantaged_communities/raw/main/results/DAC_s.csv") # DAC data
```


# Create the final dataset
```{r}
sf_use_s2(FALSE)
output <- data %>% 
  st_as_sf(coords = c("Long", "Lat"), crs = 4269,
           agr = "constant",
           stringsAsFactors = FALSE,
           remove = TRUE) %>% 
  mutate(Type = ifelse(Product == "BF-BOF", "BF_I", 
                       ifelse(Product %in% c("Coke","Ore"), "Others", 
                              Product))) %>% 
  st_join(tr.sf %>% 
            rename(GEOID = FIPS) %>% 
            dplyr::select(GEOID) %>% 
            inner_join(DAC, by = "GEOID"))

```